(()=>{"use strict";const e=class{constructor(e,t){let{inputSelector:s,submitButtonSelector:i,inactiveButtonClass:n,inputErrorClass:o,errorClass:r}=t;this._form=e,this._inputSelector=s,this._submitButtonSelector=i,this._inactiveButtonClass=n,this._inputErrorClass=o,this._errorClass=r}enableValidation(){this._inputList=Array.from(this._form.querySelectorAll(this._inputSelector)),this._buttonElement=this._form.querySelector(this._submitButtonSelector),this._setEventListeners()}_setEventListeners(){this.disableButton(),this._inputList.forEach((e=>{e.addEventListener("input",(()=>{this._checkInputValidity(e),this._hasInvalidInput()?this.disableButton():this._enableButton()}))}))}_hasInvalidInput(){return this._inputList.some((e=>!e.validity.valid))}_checkInputValidity(e){e.checkValidity()?this._hideInputError(e):this._showInputError(e)}_showInputError(e){e.classList.add(this._inputErrorClass),document.querySelector(`#${e.id}-error`).textContent=e.validationMessage}_hideInputError(e){document.querySelector(`#${e.id}-error`).textContent="",e.classList.remove(this._inputErrorClass)}_enableButton(){this._buttonElement.classList.remove(this._inactiveButtonClass),this._buttonElement.removeAttribute("disabled")}disableButton(){this._buttonElement.classList.add(this._inactiveButtonClass),this._buttonElement.setAttribute("disabled",!0)}},t=class{constructor(e,t,s){this._data=e,this._selectorTemplate=t,this._openImage=s}_getTemplateCard(){return document.querySelector(this._selectorTemplate).content.querySelector(".elements__item").cloneNode(!0)}_actionLike=()=>{this._likeButton.classList.toggle("element__like_active")};_actionPopupWrapImage=()=>{this._openImage(this._data)};_actionDelete=()=>{this._cloneCard.remove(),this._cloneCard=null};_setEventListener(){this._likeButton.addEventListener("click",this._actionLike),this._deleteIcon.addEventListener("click",this._actionDelete),this._imageElement.addEventListener("click",this._actionPopupWrapImage)}createCard(){return this._cloneCard=this._getTemplateCard(),this._likeButton=this._cloneCard.querySelector(".element__like"),this._deleteIcon=this._cloneCard.querySelector(".elements__delete-btn"),this._imageElement=this._cloneCard.querySelector(".element__image"),this._nameCard=this._cloneCard.querySelector(".element__title"),this._setEventListener(),this._imageElement.src=this._data.link,this._imageElement.alt=this._data.name,this._nameCard.textContent=this._data.name,this._cloneCard}};class s{constructor(e){this._popup=document.querySelector(e),this._popupCloseButton=this._popup.querySelector(".popup__close")}_handleCloseEsc=e=>{"Escape"===e.key&&this.close()};_handleCloseButton=()=>{this.close()};_handleClickOverlay=e=>{e.target.classList.contains("popup_opened")&&this.close()};setEventListeners(){this._popupCloseButton.addEventListener("click",this._handleCloseButton),this._popup.addEventListener("mousedown",this._handleClickOverlay)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleCloseEsc)}close(){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleCloseEsc)}}class i extends s{constructor(e,t){super(e),this._submitForm=t,this._form=this._popup.querySelector(".popup__form"),this._inputList=this._form.querySelectorAll(".popup__input")}getInputValues(){return this._values={},this._inputList.forEach((e=>{this._values[e.name]=e.value})),this._values}setInputValues(e){this._inputList.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListeners(),this._form.addEventListener("submit",(e=>{e.preventDefault();const t=this.getInputValues();this._submitForm(t),this.close()}))}close(){super.close(),this._form.reset()}}const n=document.querySelector(".profile__edit-button"),o=document.querySelector(".profile__add-button"),r=document.querySelector(".popup__form_edit"),l=document.querySelector(".popup__form_new"),a=".card-template",p={inputSelector:".popup__input",submitButtonSelector:".popup__button",inactiveButtonClass:"popup__button_invalid",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},u=new e(r,p),c=new e(l,p);c.enableValidation(),u.enableValidation();const _=new class{constructor(e){this._profileTitle=document.querySelector(e.profileTitleSelector),this._profileSubtitle=document.querySelector(e.profileSubtitleSelector)}getUserInfo(){return{title:this._profileTitle.textContent,subtitle:this._profileSubtitle.textContent}}setUserInfo(e){this._profileTitle.textContent=e.title,this._profileSubtitle.textContent=e.subtitle}}({profileTitleSelector:".profile__title",profileSubtitleSelector:".profile__subtitle"}),d=new class extends s{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup__image"),this._popupImageTitle=this._popup.querySelector(".popup__image-title")}open=e=>{this._popupImage.src=e.link,this._popupImage.alt=e.name,this._popupImageTitle.textContent=e.name,super.open()}}(".popup_type_image"),h=new i(".popup_type_profile",(function(){_.setUserInfo(h.getInputValues())})),m=new i(".popup_type_add",(function(e){const s=new t(e,a,d.open).createCard(e);v.addItem(s)})),v=new class{constructor(e,t){let{items:s,renderer:i}=e;this._container=document.querySelector(t),this._initialCards=s,this.renderer=i}addCardsFromArray(){this._initialCards.forEach((e=>{this.addItem(this.renderer(e))}))}addItem(e){this._container.prepend(e)}}({items:[{name:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{name:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{name:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{name:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{name:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{name:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>new t(e,a,d.open).createCard()},".elements");v.addCardsFromArray(),h.setEventListeners(),m.setEventListeners(),d.setEventListeners(),n.addEventListener("click",(()=>{h.setInputValues(_.getUserInfo()),h.open(),u.disableButton()})),o.addEventListener("click",(()=>{m.open(),c.disableButton()}))})();